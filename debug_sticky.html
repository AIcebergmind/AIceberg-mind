<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug Sticky Button</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      height: 300vh; /* Forza lo scroll */
      background: linear-gradient(to bottom, #001122, #003344, #001122);
      color: white;
      padding: 2rem;
    }
    
    h1 {
      position: fixed;
      top: 20px;
      left: 20px;
      color: #00D4FF;
      z-index: 100;
    }
    
    .scroll-indicator {
      position: fixed;
      top: 60px;
      left: 20px;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 5px;
      z-index: 100;
    }
    
    /* STICKY BUTTON CSS - COPIATO ESATTO */
    .support-sticky-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 9999;
      transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
    }

    .support-sticky-button.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .support-sticky-button.hidden {
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
    }

    .support-button {
      background: rgba(0, 212, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 212, 255, 0.3);
      border-radius: 25px;
      padding: 12px 20px;
      color: #00D4FF;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: 'IBM Plex Sans', sans-serif;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      box-shadow: 0 4px 20px rgba(0, 212, 255, 0.1);
    }

    .support-button:hover {
      background: rgba(0, 212, 255, 0.2);
      border-color: rgba(0, 212, 255, 0.5);
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(0, 212, 255, 0.2);
    }

    .support-progress-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: rgba(0, 212, 255, 0.2);
      border-radius: 25px 25px 0 0;
      overflow: hidden;
    }

    .support-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #00D4FF, #0099CC);
      width: 0%;
      transition: width 0.1s ease-out;
      border-radius: 25px 25px 0 0;
    }

    .support-icon {
      font-size: 16px;
      color: #00D4FF;
    }

    .support-text {
      color: #ffffff;
      white-space: nowrap;
    }
    
    /* TEST: FORZA VISIBILITÀ */
    .support-sticky-button.debug-visible {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0) !important;
      background: red !important;
    }
  </style>
</head>
<body>

  <h1>Debug Sticky Button</h1>
  <div class="scroll-indicator" id="scrollInfo">Scroll: 0%</div>

  <div style="margin-top: 200px;">
    <h2>Scorri la pagina...</h2>
    <p>Il sticky button dovrebbe apparire dopo 10% di scroll</p>
    <p>Controlla la console per i log JavaScript</p>
  </div>

  <div style="margin-top: 100vh;">
    <h2>Metà pagina</h2>
    <p>Progress bar dovrebbe essere al 50%</p>
  </div>

  <div style="margin-top: 100vh;">
    <h2>Fine pagina</h2>
    <p>Button dovrebbe scomparire al 100%</p>
  </div>

  <!-- Support Sticky Button - FORZA VISIBILE INIZIALMENTE -->
  <div id="supportStickyButton" class="support-sticky-button debug-visible">
    <div class="support-progress-container">
      <div class="support-progress-bar"></div>
    </div>
    <button class="support-button" type="button" onclick="alert('FUNZIONA!')">
      <span class="support-icon">▣</span>
      <span class="support-text">Support Us</span>
    </button>
  </div>

  <script>
    console.log('🔥 DEBUG: Inizializzazione...');
    
    const supportButton = document.getElementById('supportStickyButton');
    const progressBar = supportButton.querySelector('.support-progress-bar');
    const scrollInfo = document.getElementById('scrollInfo');
    
    let isVisible = false;
    
    function updateSticky() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollProgress = Math.min((scrollTop / documentHeight) * 100, 100);
      
      // Aggiorna info debug
      scrollInfo.textContent = `Scroll: ${scrollProgress.toFixed(1)}%`;
      
      // Aggiorna progress bar
      progressBar.style.width = `${scrollProgress}%`;
      
      // Logica visibilità
      const shouldShow = scrollProgress > 10 && scrollProgress < 100;
      
      console.log(`📊 Scroll: ${scrollProgress.toFixed(1)}%, Should show: ${shouldShow}, Is visible: ${isVisible}`);
      
      if (shouldShow && !isVisible) {
        supportButton.classList.remove('debug-visible', 'hidden');
        supportButton.classList.add('visible');
        isVisible = true;
        console.log('✅ Button mostrato');
      } else if (!shouldShow && isVisible) {
        supportButton.classList.remove('visible');
        supportButton.classList.add('hidden');
        isVisible = false;
        console.log('❌ Button nascosto');
      }
    }
    
    // Event listeners
    window.addEventListener('scroll', updateSticky, { passive: true });
    
    // Test iniziale dopo 2 secondi
    setTimeout(() => {
      console.log('🧪 Rimuovo debug-visible per test normale...');
      supportButton.classList.remove('debug-visible');
      updateSticky();
    }, 2000);
    
    console.log('✅ Debug script caricato');
  </script>

</body>
</html>
